repos:
  - repo: local
    hooks:
      # ðŸ” Secrets Detection
      - id: gitleaks
        name: Gitleaks â€“ Secrets Scanning
        entry: gitleaks detect --source . --redact --verbose
        language: system
        image: zricethezav/gitleaks:latest
        pass_filenames: false
        stages: [commit]

      # ðŸ§  SAST
      - id: semgrep-sast
        name: Semgrep â€“ SAST
        entry: semgrep --config=auto --error
        language: system
        image: semgrep/semgrep
        pass_filenames: false
        stages: [commit]

      # â˜ï¸ IaC Security
      - id: checkov-iac
        name: Checkov â€“ IaC Scan
        entry: checkov --directory .
        language: system
        image: bridgecrew/checkov:latest
        pass_filenames: false
        stages: [commit]

      # ðŸš¨ Aggregated Security Gate
      - id: corporate-security-critical
        name: Corporate Security â€“ Critical Gate
        entry: >
          bash -c "
          pre-commit run gitleaks &&
          pre-commit run semgrep-sast &&
          pre-commit run checkov-iac
          "
        language: system
        pass_filenames: false
        always_run: true
        stages: [commit]